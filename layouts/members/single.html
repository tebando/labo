{{ define "main" }}

{{ $isEn := eq site.Language.Lang "en" }}
{{ $name := .Params.member_name | default .Title }}
{{ $role := .Params.role | default "-" }}
{{ $degree := .Params.degree | default "-" }}
{{ $affiliation := .Params.affiliation | default "-" }}
{{ $website := .Params.website | default "" }}
{{ $education := .Params.education_career }}
{{ $researchFallback := cond $isEn "Please add research details." "研究内容を記入してください。" }}
{{ $comingSoon := cond $isEn "Information coming soon." "記載準備中です。" }}
{{ $research := .Params.research_overview | default $researchFallback }}
{{ $awards := .Params.awards }}
{{ $journal := slice }}
{{ $oral := slice }}
{{ $misc := slice }}
{{ $profileLabel := cond $isEn "Profile" "プロフィール" }}
{{ $nameLabel := cond $isEn "Name" "氏名" }}
{{ $positionLabel := cond $isEn "Position" "職位" }}
{{ $degreeLabel := cond $isEn "Degree" "学位" }}
{{ $affiliationLabel := cond $isEn "Affiliation" "所属" }}
{{ $educationLabel := cond $isEn "Education and Career" "学歴・職歴" }}
{{ $researchLabel := cond $isEn "Research" "研究" }}
{{ $awardsLabel := cond $isEn "Awards" "受賞歴" }}
{{ $publicationsLabel := cond $isEn "Publications" "研究業績" }}
{{ $journalLabel := cond $isEn "Peer-reviewed Journals" "論文誌(査読付き)" }}
{{ $oralLabel := cond $isEn "Oral Presentations" "口頭発表" }}
{{ $freeTextLabel := cond $isEn "Additional Notes" "自由記述" }}
{{ with .Params.publications }}
  {{ with .journal_peer_reviewed }}{{ $journal = . }}{{ end }}
  {{ with .oral_presentations }}{{ $oral = . }}{{ end }}
  {{ with .misc }}{{ $misc = . }}{{ end }}
{{ end }}
{{ if and (eq (len $journal) 0) (eq (len $oral) 0) (eq (len $misc) 0) .Params.research_outputs }}
  {{ $journal = .Params.research_outputs }}
{{ end }}

<section class="section">
  <div class="container">
    <article class="member-bio-card">
      <div class="row no-gutters member-bio-top">
        <div class="col-lg-4 order-lg-2 member-bio-side">
          <div class="member-bio-figure">
            {{ with .Params.profile_image }}
            {{ partial "image.html" (dict "Src" . "Alt" (printf "%s photo" $name) "Class" "img-fluid member-bio-image" ) }}
            {{ else }}
            <div class="member-bio-image-placeholder">No Image</div>
            {{ end }}
          </div>
        </div>
        <div class="col-lg-8 order-lg-1 member-bio-main">
          <section class="member-bio-section">
            <h2 class="member-bio-section-title">{{ $profileLabel }}</h2>
            <div class="table-responsive member-bio-fact-wrap">
              <table class="table member-bio-fact-table">
                <tbody>
                  <tr>
                    <th>{{ $nameLabel }}</th>
                    <td>{{ $name }}</td>
                  </tr>
                  <tr>
                    <th>{{ $positionLabel }}</th>
                    <td>{{ $role }}</td>
                  </tr>
                  <tr>
                    <th>{{ $degreeLabel }}</th>
                    <td>{{ $degree }}</td>
                  </tr>
                  <tr>
                    <th>{{ $affiliationLabel }}</th>
                    <td>{{ $affiliation }}</td>
                  </tr>
                  <tr>
                    <th>URL</th>
                    <td>
                      {{ if $website }}
                      <a class="member-bio-url" href="{{ $website | safeURL }}" target="_blank" rel="noopener noreferrer">{{ $website }}</a>
                      {{ else }}
                      -
                      {{ end }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <section class="member-bio-section">
            <h2 class="member-bio-section-title">{{ $educationLabel }}</h2>
            {{ if $education }}
            <ul class="member-bio-list">
              {{ range $education }}
              <li>{{ . }}</li>
              {{ end }}
            </ul>
            {{ else }}
            <p class="member-bio-section-text">{{ $comingSoon }}</p>
            {{ end }}
          </section>
        </div>
      </div>

      <div class="member-bio-wide">
        <section class="member-bio-section">
          <h2 class="member-bio-section-title">{{ $researchLabel }}</h2>
          <p class="member-bio-section-text">{{ $research | markdownify }}</p>
        </section>

        <section class="member-bio-section">
          <h2 class="member-bio-section-title">{{ $awardsLabel }}</h2>
          {{ if $awards }}
          <ul class="member-bio-list">
            {{ range $awards }}
            <li>{{ . }}</li>
            {{ end }}
          </ul>
          {{ else }}
          <p class="member-bio-section-text">{{ $comingSoon }}</p>
          {{ end }}
        </section>

        <section class="member-bio-section">
          <h2 class="member-bio-section-title">{{ $publicationsLabel }}</h2>
          <h3 class="member-bio-subtitle">{{ $journalLabel }}</h3>
          {{ partial "member_publication_items.html" (dict "items" $journal) }}

          <h3 class="member-bio-subtitle">{{ $oralLabel }}</h3>
          {{ partial "member_publication_items.html" (dict "items" $oral) }}

          <h3 class="member-bio-subtitle">MISC</h3>
          {{ partial "member_publication_items.html" (dict "items" $misc) }}
        </section>

        {{ if .Content }}
        <section class="member-bio-section">
          <h2 class="member-bio-section-title">{{ $freeTextLabel }}</h2>
          <div class="content">{{ .Content }}</div>
        </section>
        {{ end }}
      </div>
    </article>
  </div>
</section>

{{ end }}

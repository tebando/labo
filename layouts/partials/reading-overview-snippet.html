{{- $raw := .RawContent | default "" -}}
{{- $summary := "" -}}

{{- $matches := findRESubmatch `(?s)##\s*概要\s*(.*?)(?:\n##\s|$)` $raw 1 -}}
{{- if gt (len $matches) 0 -}}
  {{- $summary = index (index $matches 0) 1 -}}
{{- end -}}

{{- if not $summary -}}
  {{- $summary = .Plain -}}
{{- end -}}

{{- $summary = replaceRE `(?m)^\s*[-*+]\s*` "" $summary -}}
{{- $summary = replaceRE `\r?\n` " " $summary -}}
{{- $summary = replaceRE `\s+` " " $summary | strings.TrimSpace -}}

{{- return (truncate 200 $summary) -}}
